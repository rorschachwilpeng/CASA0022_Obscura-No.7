# 电子墨水屏幕连接指南

本指南将介绍如何将Waveshare电子墨水屏幕连接到树莓派。以下以Waveshare 2.13英寸电子墨水屏幕为例，其他型号的连接方式可能略有不同。

## 所需硬件

1. 树莓派（任何型号都可以，推荐树莓派3B+或4B）
2. Waveshare电子墨水显示屏（本例中使用2.13英寸V2版本）
3. 杜邦线（公对母）
4. (可选) 面包板，用于测试

## 接线说明

### Waveshare电子墨水显示屏引脚说明

Waveshare电子墨水显示屏通常使用SPI接口与树莓派通信。以下是标准的引脚定义：

| 电子墨水屏引脚 | 功能       | 树莓派GPIO引脚 | 备注                      |
|--------------|------------|--------------|--------------------------|
| VCC          | 3.3V电源    | 3.3V (引脚1)  | 电源                      |
| GND          | 接地        | GND (引脚6)   | 接地                      |
| DIN          | MOSI       | GPIO10 (引脚19) | SPI数据输入               |
| CLK          | SCLK       | GPIO11 (引脚23) | SPI时钟                   |
| CS           | CE0        | GPIO8 (引脚24)  | SPI片选                   |
| DC           | 数据/命令控制 | GPIO25 (引脚22) | 数据/命令选择线            |
| RST          | 复位        | GPIO17 (引脚11) | 显示屏复位                 |
| BUSY         | 忙状态指示   | GPIO24 (引脚18) | 显示屏忙状态指示            |

### 接线步骤

1. 确保树莓派已关机，并断开电源
2. 使用杜邦线将电子墨水显示屏连接到树莓派，按照上表中的对应关系进行连接
3. 检查所有连接是否正确且牢固
4. 接通树莓派电源

## 接线图

```
+-------------+                                   +----------------+
|  树莓派      |                                   |  电子墨水显示屏  |
|             |                                   |                |
|         3.3V+-----------------------------------+VCC            |
|          GND+-----------------------------------+GND            |
|        GPIO10+----------------------------------+DIN            |
|        GPIO11+----------------------------------+CLK            |
|         GPIO8+----------------------------------+CS             |
|        GPIO25+----------------------------------+DC             |
|        GPIO17+----------------------------------+RST            |
|        GPIO24+----------------------------------+BUSY           |
+-------------+                                   +----------------+
```

## 软件设置

1. 启用SPI接口：
```bash
sudo raspi-config
```
在接口选项中启用SPI

2. 安装必要的Python库
```bash
sudo apt-get update
sudo apt-get install python3-pip python3-pil python3-numpy
sudo pip3 install RPi.GPIO spidev
```

3. 安装Waveshare提供的库
```bash
# 克隆Waveshare的示例代码仓库
git clone https://github.com/waveshare/e-Paper.git
# 创建库目录
mkdir -p lib/waveshare
# 复制必要的库文件
cp -r e-Paper/RaspberryPi_JetsonNano/python/lib/* lib/waveshare/
```

## 测试连接

在完成硬件连接和软件设置后，您可以运行Waveshare提供的示例程序来测试您的设置：

```bash
cd e-Paper/RaspberryPi_JetsonNano/python/examples
# 选择与您的显示屏型号对应的示例文件
python3 epd_2in13_V2_test.py
```

如果一切正常，您应该能看到电子墨水显示屏上显示测试图像。

## 疑难解答

1. **显示屏没有反应**：检查接线是否正确，确保SPI接口已启用。
2. **显示异常或错误**：确认是否使用了正确的驱动程序，不同版本的显示屏可能需要不同的驱动程序。
3. **运行示例出错**：确保已安装所有必要的库，并且库的版本兼容。

## 接下来

成功连接电子墨水显示屏后，您可以运行本项目中的`display_on_eink.py`脚本来显示生成的天气艺术图像：

```bash
python3 display_on_eink.py --image weather_art.png --width 122 --height 250
```

注意：根据您实际的电子墨水显示屏型号，您可能需要调整脚本中的导入语句和分辨率参数。 