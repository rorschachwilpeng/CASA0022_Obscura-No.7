# 🧪 Obscura No.7 测试指南

## 📋 概述

本指南提供了完整的测试方案，让你能够在**没有树莓派硬件**的情况下验证整个系统的功能。

## 🎯 测试目标

- ✅ 验证云端API功能
- ✅ 测试网站前端可视化
- ✅ 模拟树莓派完整工作流
- ✅ 确保端到端数据流正常

## 🚀 快速开始

### 1. 一键运行所有测试
```bash
python run_all_tests.py
```

### 2. 单独运行测试

#### 快速API测试
```bash
python quick_api_test.py
```

#### 前端功能测试
```bash
python test_website_frontend.py
```

#### 树莓派工作流模拟
```bash
python test_raspberry_pi_simulation.py
```

## 📊 测试脚本详解

### `quick_api_test.py` - 快速API测试
**用途**: 快速验证云端API是否正常工作

**测试内容**:
- 健康检查接口
- ML预测API (伦敦、曼彻斯特、爱丁堡)
- 响应时间和数据格式验证

**预期结果**:
```
✅ 网站正常运行
✅ 预测成功
🌡️ 温度: 12.5°C
💧 湿度: 65.2%
🌀 气压: 1013.4 hPa
```

### `test_website_frontend.py` - 前端测试
**用途**: 验证网站前端页面和用户界面

**测试内容**:
- 所有页面可访问性
- API端点响应
- 可选择在浏览器中打开进行手动测试

**预期结果**:
```
✅ 页面正常 (大小: 15234 bytes)
✅ 包含项目标识
✅ API正常
```

### `test_raspberry_pi_simulation.py` - 完整工作流模拟
**用途**: 模拟树莓派的完整7步工作流

**测试内容**:
1. 🔗 API连接测试
2. 🔧 硬件输入模拟
3. 📍 坐标计算
4. 🤖 ML预测API调用
5. 🎨 艺术提示词生成
6. 🖼️ 图像生成模拟
7. ☁️ 云端上传模拟

**预期结果**:
```
✅ 完整工作流测试成功！
🎯 验证的功能:
  ✓ 云端API连接
  ✓ 硬件输入模拟
  ✓ 坐标计算
  ✓ ML预测API调用
  ✓ 艺术提示词生成
  ✓ 图像生成流程
  ✓ 云端上传流程
```

### `run_all_tests.py` - 一键测试套件
**用途**: 运行所有测试并生成综合报告

**功能**:
- 顺序运行所有测试
- 生成详细测试报告
- 提供交互式选项
- 在浏览器中打开网站

## 🌐 云端API信息

**API基础URL**: `https://casa0022-obscura-no-7.onrender.com`

**主要端点**:
- `GET /health` - 健康检查
- `POST /api/v1/ml/predict` - ML预测
- `GET /api/v1/ml/model/info` - 模型信息
- `GET /prediction` - 预测页面

## 🧪 测试数据

### 标准测试坐标
- **伦敦**: 51.5074, -0.1278
- **曼彻斯特**: 53.4808, -2.2426
- **爱丁堡**: 55.9533, -3.1883

### 预测请求格式
```json
{
    "latitude": 51.5074,
    "longitude": -0.1278,
    "month": 8,
    "future_years": 0
}
```

## 📱 手动测试检查点

### 预测页面测试
1. 打开 `https://casa0022-obscura-no-7.onrender.com/prediction`
2. 输入测试坐标
3. 点击"PREDICT ENVIRONMENT"
4. 检查结果显示

### 检查项目
- [ ] 页面正常加载
- [ ] 蒸汽朋克风格正确显示
- [ ] 表单可以提交
- [ ] 加载动画正常
- [ ] 结果卡片正确显示
- [ ] 响应式设计在不同屏幕尺寸下正常

## 🛠️ 故障排除

### 常见问题

#### 1. 连接失败
```
❌ 连接失败: Connection timeout
```
**解决方案**: 
- 检查网络连接
- 确认API URL是否正确
- 等待几分钟后重试（Render可能需要唤醒）

#### 2. 预测失败
```
❌ 预测失败: 500 Internal Server Error
```
**解决方案**:
- 检查请求数据格式
- 确认经纬度在有效范围内
- 查看API错误日志

#### 3. 页面加载异常
```
❌ 页面异常: 404 Not Found
```
**解决方案**:
- 确认URL路径正确
- 检查前端路由配置
- 确认模板文件存在

## 🎯 测试通过标准

### 关键测试（必须全部通过）
1. ✅ 快速API连通性测试
2. ✅ 网站前端功能测试
3. ✅ 树莓派工作流模拟测试

### 成功指标
- API响应时间 < 30秒
- 预测精度合理（温度在-20°C到50°C之间）
- 所有页面正常加载
- 无JavaScript错误

## 📈 下一步行动

### 测试通过后
1. 🌐 在浏览器中体验完整功能
2. 🥧 准备树莓派硬件
3. 🔗 配置Tailscale网络
4. 🚀 部署实际硬件代码

### 测试失败时
1. 📝 记录具体错误信息
2. 🔍 检查API状态和日志
3. 🔧 修复问题后重新测试
4. 💬 联系开发者获取支持

## 🎉 预期结果

成功运行所有测试后，你将看到：

```
🎉 系统状态: 全部就绪！
✅ 所有关键测试通过
🚀 可以开始使用系统

🌐 你可以访问以下链接:
   主页: https://casa0022-obscura-no-7.onrender.com/
   预测页面: https://casa0022-obscura-no-7.onrender.com/prediction
   图库: https://casa0022-obscura-no-7.onrender.com/gallery

🎯 下一步行动:
   1. 在浏览器中测试预测页面
   2. 准备树莓派硬件连接
   3. 配置Tailscale网络
   4. 部署真实的树莓派代码
```

这意味着你的整个系统已经可以正常工作，只需要连接真实的树莓派硬件即可！ 